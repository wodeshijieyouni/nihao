
<div class="pageContent">
	<form method="post" enctype="multipart/form-data" action="__URL__/insert/navTabId/listgod/callbackType/closeCurrent"  class="pageForm required-validate" 
		onsubmit="return iframeCallback(this,dialogAjaxDone);"><?php  //窗体组件采用这个 iframeCallback(this, navTabAjaxDone); ?>
		<div class="pageFormContent" layoutH="60">
			<dl>
				<dt>商品类别：</dt>
				<dd>
					<select name="category_name">
						<option value="">-请选择-</option>
						<foreach name='list' item="vo">
							<option value="{$vo.category_name}" {$vo['pid']==0 ? "disabled" : ""}>{$vo.category_path|outTypeInfo}{$vo.category_name}</option>
						</foreach>
					</select>
				</dd>
			</dl>
			
			<dl>
				<dt>商品名称：</dt>
				<dd><input type="text" class="required"  style="width:100%" name="goods_name"/></dd>
			</dl>
			<dl>
				<dt>商品描述：</dt>
				<dd><input type="text"  style="width:100%" name="goods_desc"/></dd>
			</dl>
			<dl>
				<dt>商品价格：</dt>
				<dd><input type="text" class="required"  style="width:100%" name="shop_price"/></dd>
			</dl>
			<dl>
				<dt>促销价格：</dt>
				<dd><input type="text"  style="width:100%" name="promote_price"/></dd>
			</dl>
			<dl>
				<dt>商品库存：</dt>
				<dd><input type="text"  style="width:100%" name="goods_stock"/></dd>
			</dl> 
			<dl>
				<dt>商品图片：</dt>
				<dd>
					<input id="file_upload" type="file" name="goods_img" />
					<div class="image_container">
					<img id="preview" width="60" height="60">
					</div>
				</dd>
			</dl>
			<!-- <input type="hidden" name="goods_add_time" value="1"> -->
		</div>
		
		<div class="formBar">
			<ul>
				<li><div class="buttonActive"><div class="buttonContent"><button type="submit">保存</button></div></div></li>
				<li><div class="button"><div class="buttonContent"><button type="button" class="close">取消</button></div></div></li>
			</ul>
		</div>
	</form>
	<script type="text/javascript">
		$(function() {
$("#file_upload").change(function() {
var $file = $(this);
var fileObj = $file[0];
var windowURL = window.URL || window.webkitURL;
var dataURL;
var $img = $("#preview");
 
if(fileObj && fileObj.files && fileObj.files[0]){
dataURL = windowURL.createObjectURL(fileObj.files[0]);
$img.attr('src',dataURL);
}else{
dataURL = $file.val();
var imgObj = document.getElementById("preview");
// 两个坑:
// 1、在设置filter属性时，元素必须已经存在在DOM树中，动态创建的Node，也需要在设置属性前加入到DOM中，先设置属性在加入，无效；
// 2、src属性需要像下面的方式添加，上面的两种方式添加，无效；
imgObj.style.filter = "progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";
imgObj.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = dataURL;
 
}
});
});
	</script>
</div>

